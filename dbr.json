{
  "meta": {
    "id": "fundus_triage_pairwise_proxy_v2",
    "title": "Fundus Triage AI — Responsible Innovation Parameter Lab",
    "subtitle": "A fast Monte Carlo proxy simulator for an AI diagnostic triage app that ranks fundus images by disease severity using pairwise comparisons. Adjust technical, governance, compute, and adoption parameters and watch outcome distributions update in real time.",
    "footerNote": "Note: This simulator is a toy proxy model for exploring trade-offs. It is not validated, not medical advice, and not a substitute for clinical safety evaluation, regulatory assessment, or health system governance."
  },

  "project": {
    "name": "Pairwise-Ranking Fundus Triage AI",
    "description": [
      "The system supports clinical triage by ranking fundus images by estimated severity using pairwise comparisons (e.g., A more severe than B).",
      "Outputs are used to prioritize review and referral rather than to replace diagnosis. Performance and trust depend on data quality, labeling reliability, calibration, distribution shift, compute constraints, adoption dynamics, and responsible innovation governance (AREA) plus reporting (TRIPOD-AI and related standards)."
    ],
    "promptTemplate": {
      "title": "AI Prompt Generator",
      "instructions": "Add project details (e.g., target disease(s), care pathway, devices, population, deployment sites, human-in-the-loop, governance plan). Click “Generate AI Prompt” to produce a prompt you can paste into an AI assistant for a short report interpreting the current settings.",
      "defaultAssumptions": "[No additional refinements provided. State reasonable assumptions.]",
      "promptText": [
        "You are an expert in responsible innovation, clinical AI, ophthalmology pathways, and evaluation/reporting standards (TRIPOD-AI, CONSORT-AI, SPIRIT-AI).",
        "Write a short report (700–1,000 words) interpreting the likely outcomes of deploying an AI diagnostic triage app for fundus images under the current parameter settings.",
        "",
        "System summary:",
        "- The model ranks fundus images by severity using pairwise comparisons to produce a triage ordering/priority score.",
        "- The tool supports workflow prioritization (human-in-the-loop), not autonomous diagnosis.",
        "- Responsible innovation governance is guided by AREA (anticipation, reflection, engagement, action).",
        "- Reporting and validation discipline is aligned with TRIPOD-AI and related frameworks.",
        "",
        "Current parameter settings (0–100):",
        "{{PARAMETERS_LIST}}",
        "",
        "Please do ALL of the following:",
        "1) Explain how these settings shape safety and clinical usefulness (triage gain vs harm), including calibration and distribution shift risks.",
        "2) Discuss expected effects on adoption, regulatory acceptance, operational throughput, and compute/budget feasibility.",
        "3) Identify main failure modes (bias, drift, workflow mismatch, alert fatigue, over-/under-triage, data leakage) and the biggest levers to mitigate them.",
        "4) Recommend 5 practical next actions aligned to AREA (anticipation, reflection, engagement, action), and specify what TRIPOD-AI-style reporting would need to cover.",
        "5) Be explicit about uncertainty and what evidence (prospective studies, silent trials, audits, stress tests, post-deployment monitoring) would reduce it.",
        "",
        "Project refinements supplied by the user (incorporate these carefully; if empty, state assumptions you made):",
        "{{REFINEMENTS}}"
      ]
    }
  },

  "ui": {
    "layout": {
      "leftPanelTitle": "Project Parameters (sliders)",
      "rightPanelTitle": "Likely Outcomes (distributions + summary stats)",
      "chartsTitle": "Likely Outcomes (distributions)"
    },
    "controls": {
      "liveUpdateLabel": "Live update",
      "drawsLabel": "Monte Carlo draws",
      "debounceLabel": "Update rate (ms debounce)",
      "buttons": [
        { "id": "btnRandomize", "label": "Randomize params" },
        { "id": "btnReset", "label": "Reset defaults" },
        { "id": "btnToggleLive", "label": "Toggle live update" },
        { "id": "btnRecompute", "label": "Recompute now" }
      ]
    },
    "promptUI": {
      "refinementsPlaceholder": "Describe your fundus triage project refinements here…\nExamples:\n- Target condition(s): DR, AMD, glaucoma, hypertensive retinopathy\n- Camera types, image quality, acquisition workflow\n- Intended triage thresholds and care pathway integration\n- Human-in-the-loop design and escalation rules\n- Data sources, labeling/pairwise comparison method, privacy approach\n- AREA plan, stakeholder engagement, monitoring/audit cadence\n- Deployment setting constraints (primary care, community screening, ED)\n- Known adoption barriers (clinician trust, procurement, liability)",
      "buttons": [
        { "id": "btnGenPrompt", "label": "Generate AI Prompt" },
        { "id": "btnCopyPrompt", "label": "Copy Prompt" },
        { "id": "btnClearRefinements", "label": "Clear refinements" }
      ],
      "promptOutputPlaceholder": "Generated prompt will appear here…"
    }
  },

  "parameters": [
    {
      "id": "dataQuality",
      "label": "Fundus image quality & metadata completeness",
      "hint": "Higher improves robustness and reduces spurious ranking signals (blur, glare, field-of-view issues).",
      "min": 0, "max": 100, "step": 1, "default": 65
    },
    {
      "id": "labelReliability",
      "label": "Pairwise label reliability (grader agreement)",
      "hint": "Higher improves ranking consistency; low reliability increases noisy supervision and uncertain triage ordering.",
      "min": 0, "max": 100, "step": 1, "default": 60
    },
    {
      "id": "caseMixShift",
      "label": "Distribution shift risk (devices, populations, prevalence)",
      "hint": "Higher increases drift and harms calibration; requires monitoring, revalidation, and domain adaptation.",
      "min": 0, "max": 100, "step": 1, "default": 45
    },
    {
      "id": "biasImprint",
      "label": "Equity risk (demographic & access-related bias)",
      "hint": "Higher increases disparity risk (performance gaps across groups). Mitigate via diverse data, auditing, and constraints.",
      "min": 0, "max": 100, "step": 1, "default": 35
    },
    {
      "id": "calibrationEffort",
      "label": "Calibration & thresholding effort (triage safety tuning)",
      "hint": "Higher reduces over-/under-triage via better calibration, threshold selection, and uncertainty handling.",
      "min": 0, "max": 100, "step": 1, "default": 55
    },
    {
      "id": "explainability",
      "label": "Explainability & clinician-facing rationale quality",
      "hint": "Higher supports trust and appropriate use; also helps audits and incident investigation.",
      "min": 0, "max": 100, "step": 1, "default": 50
    },
    {
      "id": "areaMaturity",
      "label": "AREA governance maturity (anticipation/reflection/engagement/action)",
      "hint": "Higher means stronger responsible innovation practice: scenario planning, reflection loops, stakeholder engagement, and corrective action.",
      "min": 0, "max": 100, "step": 1, "default": 55
    },
    {
      "id": "tripodDiscipline",
      "label": "TRIPOD-AI reporting & validation discipline",
      "hint": "Higher improves transparency and regulator confidence; costs time/compute but reduces hidden failure modes.",
      "min": 0, "max": 100, "step": 1, "default": 60
    },
    {
      "id": "computeCapacity",
      "label": "Compute capacity (training + evaluation throughput)",
      "hint": "Higher supports larger models, cross-site validation, robustness tests, and faster iteration.",
      "min": 0, "max": 100, "step": 1, "default": 50
    },
    {
      "id": "budget",
      "label": "Budget capacity (data, compute, governance, integration)",
      "hint": "Higher improves feasibility across compute, clinical evaluation, and workflow integration.",
      "min": 0, "max": 100, "step": 1, "default": 50
    },
    {
      "id": "workflowFit",
      "label": "Workflow fit (integration, user experience, pathway alignment)",
      "hint": "Higher reduces friction and improves real triage gains; low fit risks alert fatigue and workaround behavior.",
      "min": 0, "max": 100, "step": 1, "default": 45
    },
    {
      "id": "stakeholderSupport",
      "label": "Stakeholder support (clinical champions, procurement, leadership)",
      "hint": "Higher improves adoption probability and sustained resourcing (training, governance, incident response).",
      "min": 0, "max": 100, "step": 1, "default": 45
    },

    {
      "id": "draws",
      "label": "Monte Carlo draws",
      "hint": "Higher = smoother distributions; slower updates.",
      "min": 500, "max": 30000, "step": 500, "default": 8000,
      "isMeta": true
    },
    {
      "id": "debounce",
      "label": "Update rate (ms debounce)",
      "hint": "Higher reduces CPU; lower feels more “real-time”.",
      "min": 0, "max": 600, "step": 20, "default": 120,
      "isMeta": true
    }
  ],

  "outputs": [
    {
      "id": "clinicalBenefit",
      "title": "Net clinical benefit probability",
      "subtitle": "Proxy for triage gains outweighing harms (missed severe cases, over-referral, inequities).",
      "units": "probability",
      "range": { "min": 0, "max": 1 },
      "summary": { "meanFormat": "pct", "p10p90Format": "pct" }
    },
    {
      "id": "regAcceptance",
      "title": "Regulatory & governance acceptance probability",
      "subtitle": "Driven by TRIPOD-AI discipline, AREA maturity, calibration/monitoring, explainability, and drift risk.",
      "units": "probability",
      "range": { "min": 0, "max": 1 },
      "summary": { "meanFormat": "pct", "p10p90Format": "pct" }
    },
    {
      "id": "adoption",
      "title": "Adoption & sustained use probability",
      "subtitle": "Influenced by workflow fit, stakeholder support, perceived utility, and operational feasibility.",
      "units": "probability",
      "range": { "min": 0, "max": 1 },
      "summary": { "meanFormat": "pct", "p10p90Format": "pct" }
    },
    {
      "id": "throughput",
      "title": "Probability of meaningful throughput gain",
      "subtitle": "Proxy for achieving a meaningful operational throughput improvement from triage ordering, given workflow fit and drift risk.",
      "units": "probability",
      "range": { "min": 0, "max": 1 },
      "summary": { "meanFormat": "pct", "p10p90Format": "pct" }
    }
  ],

  "engine": {
    "bins": 44,

    "random": {
      "shocks": {
        "epsData":  { "type": "normal", "sigma": 0.20 },
        "epsClin":  { "type": "normal", "sigma": 0.18 },
        "epsReg":   { "type": "normal", "sigma": 0.18 },
        "epsAdopt": { "type": "normal", "sigma": 0.22 },
        "epsOps":   { "type": "normal", "sigma": 0.20 }
      }
    },

    "derived": {
      "dq":    { "op": "div", "args": [ { "var": "dataQuality" }, { "lit": 100 } ] },
      "lr":    { "op": "div", "args": [ { "var": "labelReliability" }, { "lit": 100 } ] },
      "shift": { "op": "div", "args": [ { "var": "caseMixShift" }, { "lit": 100 } ] },
      "bias":  { "op": "div", "args": [ { "var": "biasImprint" }, { "lit": 100 } ] },
      "cal":   { "op": "div", "args": [ { "var": "calibrationEffort" }, { "lit": 100 } ] },
      "exp":   { "op": "div", "args": [ { "var": "explainability" }, { "lit": 100 } ] },
      "area":  { "op": "div", "args": [ { "var": "areaMaturity" }, { "lit": 100 } ] },
      "tri":   { "op": "div", "args": [ { "var": "tripodDiscipline" }, { "lit": 100 } ] },
      "comp":  { "op": "div", "args": [ { "var": "computeCapacity" }, { "lit": 100 } ] },
      "bud":   { "op": "div", "args": [ { "var": "budget" }, { "lit": 100 } ] },
      "wf":    { "op": "div", "args": [ { "var": "workflowFit" }, { "lit": 100 } ] },
      "sup":   { "op": "div", "args": [ { "var": "stakeholderSupport" }, { "lit": 100 } ] },

      "modelCapacity": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.45 }, { "var": "comp" } ] },
          { "op": "mul", "args": [ { "lit": 0.30 }, { "var": "bud" } ] },
          { "op": "mul", "args": [ { "lit": 0.25 }, { "var": "lr" } ] }
        ]
      },

      "computeLoad": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.35 }, { "var": "tri" } ] },
          { "op": "mul", "args": [ { "lit": 0.30 }, { "var": "area" } ] },
          { "op": "mul", "args": [ { "lit": 0.25 }, { "var": "cal" } ] },
          { "op": "mul", "args": [ { "lit": 0.10 }, { "var": "shift" } ] }
        ]
      },

      "computeSupply": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.60 }, { "var": "comp" } ] },
          { "op": "mul", "args": [ { "lit": 0.40 }, { "var": "bud" } ] }
        ]
      },

      "computeGap": { "op": "sub", "args": [ { "var": "computeSupply" }, { "var": "computeLoad" } ] },

      "governanceStrength": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.55 }, { "var": "area" } ] },
          { "op": "mul", "args": [ { "lit": 0.55 }, { "var": "tri" } ] },
          { "op": "mul", "args": [ { "lit": 0.25 }, { "var": "exp" } ] },
          { "op": "mul", "args": [ { "lit": -0.35 }, { "var": "shift" } ] },
          { "op": "mul", "args": [ { "lit": -0.20 }, { "var": "bias" } ] }
        ]
      },

      "adoptionReadiness": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.55 }, { "var": "wf" } ] },
          { "op": "mul", "args": [ { "lit": 0.50 }, { "var": "sup" } ] },
          { "op": "mul", "args": [ { "lit": 0.20 }, { "var": "exp" } ] },
          { "op": "mul", "args": [ { "lit": -0.25 }, { "var": "shift" } ] }
        ]
      },

      "equityRisk": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.70 }, { "var": "bias" } ] },
          { "op": "mul", "args": [ { "lit": 0.35 }, { "var": "shift" } ] },
          { "op": "mul", "args": [ { "lit": -0.45 }, { "var": "area" } ] }
        ]
      }
    },

    "perDraw": {
      "dataFidelity": {
        "op": "add",
        "args": [
          { "op": "mul", "args": [ { "lit": 0.55 }, { "var": "dq" } ] },
          { "op": "mul", "args": [ { "lit": 0.35 }, { "var": "lr" } ] },
          { "op": "mul", "args": [ { "lit": -0.45 }, { "var": "shift" } ] },
          { "var": "epsData" }
        ]
      },

      "rankingQuality": {
        "op": "sigmoid",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": -0.25 },
              { "op": "mul", "args": [ { "lit": 1.20 }, { "var": "dataFidelity" } ] },
              { "op": "mul", "args": [ { "lit": 0.65 }, { "var": "modelCapacity" } ] },
              { "op": "mul", "args": [ { "lit": 0.45 }, { "var": "cal" } ] },
              { "op": "mul", "args": [ { "lit": -0.85 }, { "var": "shift" } ] },
              { "var": "epsClin" }
            ]
          }
        ]
      },

      "safetyTuning": {
        "op": "sigmoid",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": -0.15 },
              { "op": "mul", "args": [ { "lit": 0.95 }, { "var": "cal" } ] },
              { "op": "mul", "args": [ { "lit": 0.60 }, { "var": "area" } ] },
              { "op": "mul", "args": [ { "lit": -0.55 }, { "var": "computeGap" } ] },
              { "op": "mul", "args": [ { "lit": 0.10 }, { "var": "randn" } ] }
            ]
          }
        ]
      },

      "regProb": {
        "op": "sigmoid",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": -0.25 },
              { "op": "mul", "args": [ { "lit": 1.25 }, { "var": "governanceStrength" } ] },
              { "op": "mul", "args": [ { "lit": 0.35 }, { "var": "cal" } ] },
              { "op": "mul", "args": [ { "lit": -0.45 }, { "var": "equityRisk" } ] },
              { "op": "mul", "args": [ { "lit": -0.35 }, { "var": "shift" } ] },
              { "var": "epsReg" }
            ]
          }
        ]
      },

      "adoptionProb": {
        "op": "sigmoid",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": -0.20 },
              { "op": "mul", "args": [ { "lit": 1.10 }, { "var": "adoptionReadiness" } ] },
              { "op": "mul", "args": [ { "lit": 0.45 }, { "var": "regProb" } ] },
              { "op": "mul", "args": [ { "lit": 0.35 }, { "var": "rankingQuality" } ] },
              { "op": "mul", "args": [ { "lit": -0.35 }, { "var": "computeGap" } ] },
              { "var": "epsAdopt" }
            ]
          }
        ]
      },

      "throughputGain": {
        "op": "clamp",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": 1.0 },
              { "op": "mul", "args": [ { "lit": 0.90 }, { "var": "rankingQuality" } ] },
              { "op": "mul", "args": [ { "lit": 0.55 }, { "var": "adoptionProb" } ] },
              { "op": "mul", "args": [ { "lit": -0.25 }, { "var": "shift" } ] },
              { "op": "mul", "args": [ { "lit": -0.20 }, { "var": "equityRisk" } ] },
              { "op": "mul", "args": [ { "lit": 0.12 }, { "var": "randn" } ] },
              { "var": "epsOps" }
            ]
          },
          { "lit": 1.0 },
          { "lit": 2.5 }
        ]
      },

      "throughputProb": {
        "op": "clamp",
        "args": [
          {
            "op": "div",
            "args": [
              { "op": "sub", "args": [ { "var": "throughputGain" }, { "lit": 1.0 } ] },
              { "lit": 1.5 }
            ]
          },
          { "lit": 0.0 },
          { "lit": 1.0 }
        ]
      },

      "harmRisk": {
        "op": "sigmoid",
        "args": [
          {
            "op": "add",
            "args": [
              { "lit": -0.10 },
              { "op": "mul", "args": [ { "lit": 0.95 }, { "var": "shift" } ] },
              { "op": "mul", "args": [ { "lit": 0.70 }, { "var": "equityRisk" } ] },
              { "op": "mul", "args": [ { "lit": -0.80 }, { "var": "safetyTuning" } ] },
              { "op": "mul", "args": [ { "lit": -0.55 }, { "var": "rankingQuality" } ] },
              { "op": "mul", "args": [ { "lit": 0.10 }, { "var": "randn" } ] }
            ]
          }
        ]
      },

      "benefitProb": {
        "op": "clamp",
        "args": [
          {
            "op": "add",
            "args": [
              { "op": "mul", "args": [ { "lit": 0.42 }, { "var": "rankingQuality" } ] },
              { "op": "mul", "args": [ { "lit": 0.24 }, { "var": "safetyTuning" } ] },
              { "op": "mul", "args": [ { "lit": 0.18 }, { "var": "adoptionProb" } ] },
              { "op": "mul", "args": [ { "lit": 0.16 }, { "op": "sub", "args": [ { "lit": 1.0 }, { "var": "harmRisk" } ] } ] }
            ]
          },
          { "lit": 0.0 },
          { "lit": 1.0 }
        ]
      }
    },

    "outputMapping": {
      "clinicalBenefit": "benefitProb",
      "regAcceptance": "regProb",
      "adoption": "adoptionProb",
      "throughput": "throughputProb"
    }
  }
}
